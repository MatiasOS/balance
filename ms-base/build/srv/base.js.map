{"version":3,"sources":["../../srv/base.js"],"names":["tag","config","process","env","SENECA_BASE_HOST","console","log","exit","host","port","SENECA_BASE_PORT","argv","timeout","SENECA_BASE_TIMEOUT","bases","SENECA_BASE_BASES","silent","NODE_ENV","opts","seneca","internal","logger","debug","short_logs","transport","web","mesh","isbase","pin","monitor","sneeze","use","ready","id"],"mappings":";;AAAA;;;;AACA;;;;AACA;;;;;;AAEA,IAAMA,MAAM,MAAZ;;AAEA,iBAAOC,MAAP;;AAEA,IAAI,CAACC,QAAQC,GAAR,CAAYC,gBAAjB,EAAmC;;AAEjCC,UAAQC,GAAR;;AAEAJ,UAAQK,IAAR,CAAa,CAAC,CAAd;AACD;;AAED,IAAMC,OAAUN,QAAQC,GAAR,CAAYC,gBAA5B;AACA,IAAMK,OAAUP,QAAQC,GAAR,CAAYO,gBAAZ,IAAgCR,QAAQS,IAAR,CAAa,CAAb,CAAhC,IAAmD,KAAnE;AACA,IAAMC,UAAUV,QAAQC,GAAR,CAAYU,mBAA5B;AACA,IAAMC,QAAUZ,QAAQC,GAAR,CAAYY,iBAAZ,IAAiC,CAAIP,IAAJ,SAAYC,IAAZ,CAAjD;AACA,IAAMO,SAAUd,QAAQC,GAAR,CAAYc,QAAZ,KAAyB,YAAzC;;AAEA,IAAMC,OAAO;AACXC,UAAS;AACPnB,SAAYA,GADL;AAEPoB,cAAY,EAACC,kCAAD,EAFL;AAGPC,WAAY,EAACC,YAAa,IAAd,EAHL;AAIPC,eAAY;AACVC,WAAM;AACJb;AADI;AADI;AAJL,GADE;;AAYXc,QAAS;AACPC,YAAU,IADH;AAEPlB,cAFO;AAGPD,cAHO;AAIPM,gBAJO;AAKPc,mBAAkB5B,GALX;AAMP6B,aAAU,IANH;AAOPC,YAAU;AACRd;AADQ;AAPH;AAZE,CAAb;;AAyBA,sBAAOE,KAAKC,MAAZ,EACGY,GADH,CACO,MADP,EACeb,KAAKQ,IADpB,EAEGM,KAFH,CAES,YAAY;AACjB3B,UAAQC,GAAR,CAAY,KAAK2B,EAAjB;AACD,CAJH","file":"base.js","sourcesContent":["import Seneca from 'seneca'\nimport logger from 'seneca-demo-logger'\nimport dotenv from 'dotenv'\n\nconst tag = 'mesh'\n\ndotenv.config()\n\nif (!process.env.SENECA_BASE_HOST) {\n\n  console.log(`You must set: SENECA_BASE_HOST`)\n\n  process.exit(-1)\n}\n\nconst host    = process.env.SENECA_BASE_HOST\nconst port    = process.env.SENECA_BASE_PORT || process.argv[2] || 39999\nconst timeout = process.env.SENECA_BASE_TIMEOUT\nconst bases   = process.env.SENECA_BASE_BASES || [`${host}:${port}`]\nconst silent  = process.env.NODE_ENV === 'production'\n\nconst opts = {\n  seneca : {\n    tag       : tag,\n    internal  : {logger : logger},\n    debug     : {short_logs : true},\n    transport : {\n      web : {\n        timeout\n      }\n    }\n  }\n  ,\n  mesh   : {\n    isbase  : true,\n    port,\n    host,\n    bases,\n    pin     : `role:${tag}`,\n    monitor : true,\n    sneeze  : {\n      silent\n    }\n  }\n}\n\nSeneca(opts.seneca)\n  .use('mesh', opts.mesh)\n  .ready(function () {\n    console.log(this.id)\n  })\n"]}