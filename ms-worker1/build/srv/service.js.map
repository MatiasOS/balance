{"version":3,"sources":["../../srv/service.js"],"names":["config","process","env","BOILER_TAG","BOILER_HOST","BOILER_BASES","BOILER_MONGO_URI","BOILER_REDIS_TIMEOUT","console","log","exit","tag","dbname","host","bases","split","mongoUri","timeout","BOILER_TIMEOUT","silent","NODE_ENV","pin","opts","seneca","internal","logger","debug","short_logs","transport","web","mesh","sneeze","mongo","uri","use","ready","id"],"mappings":";;AAGA;;;;AACA;;;;AACA;;;;AACA;;;;;;AANA;;;AAQA,iBAAOA,MAAP;;AAEA,IAAI,CAACC,QAAQC,GAAR,CAAYC,UAAb,IACF,CAACF,QAAQC,GAAR,CAAYE,WADX,IAEF,CAACH,QAAQC,GAAR,CAAYG,YAFX,IAGF,CAACJ,QAAQC,GAAR,CAAYI,gBAHX,IAIF,CAACL,QAAQC,GAAR,CAAYK,oBAJf,EAIqC;AACnCC,UAAQC,GAAR;;AAMAR,UAAQS,IAAR,CAAa,CAAC,CAAd;AACD;AACD,IAAMC,MAAMV,QAAQC,GAAR,CAAYC,UAAxB;AACA,IAAMS,SAASX,QAAQC,GAAR,CAAYC,UAA3B;AACA,IAAMU,OAAOZ,QAAQC,GAAR,CAAYE,WAAzB;AACA,IAAMU,QAAQb,QAAQC,GAAR,CAAYG,YAAZ,CAAyBU,KAAzB,CAA+B,GAA/B,CAAd;AACA,IAAMC,WAAcf,QAAQC,GAAR,CAAYI,gBAA1B,SAA8CM,MAApD;AACA,IAAMK,UAAUhB,QAAQC,GAAR,CAAYgB,cAAZ,IAA8B,KAA9C;AACA,IAAMC,SAASlB,QAAQC,GAAR,CAAYkB,QAAZ,KAAyB,YAAxC;;AAEA,IAAMC,gBAAcV,GAApB;;AAEA,IAAMW,OAAO;AACXC,UAAQ;AACNZ,SAAKA,GADC;AAENa,cAAU,EAACC,kCAAD,EAFJ;AAGNC,WAAO,EAACC,YAAY,IAAb,EAHD;AAINC,eAAW;AACTC,WAAK;AACHZ;AADG;AADI;AAJL,GADG;AAWXa,QAAM;AACJT,YADI;AAEJP,gBAFI;AAGJD,cAHI;AAIJkB,YAAQ;AACNZ;AADM;AAJJ,GAXK;AAmBXa,SAAO;AACLC,SAAKjB;AADA;AAnBI,CAAb;;AAwBA,sBAAOM,KAAKC,MAAZ,EACGW,GADH,CACO,QADP,EAEGA,GAFH,CAEO,OAFP,EAGGA,GAHH,CAGO,aAHP,EAGsBZ,KAAKU,KAH3B,EAIGE,GAJH,kBAKGA,GALH,CAKO,MALP,EAKeZ,KAAKQ,IALpB,EAMGK,KANH,CAMS,YAAY;AACjB3B,UAAQC,GAAR,CAAY,KAAK2B,EAAjB;AACD,CARH","file":"service.js","sourcesContent":["/**\n * @module\n */\nimport Seneca from 'seneca'\nimport dotenv from 'dotenv'\nimport logger from 'seneca-demo-logger'\nimport logic from '../lib/logic'\n\ndotenv.config()\n\nif (!process.env.BOILER_TAG ||\n  !process.env.BOILER_HOST ||\n  !process.env.BOILER_BASES ||\n  !process.env.BOILER_MONGO_URI ||\n  !process.env.BOILER_REDIS_TIMEOUT) {\n  console.log(`You must set:\n        BOILER_HOST \n        BOILER_BASES \n        BOILER_MONGO_URI \n        BOILER_REDIS_TIMEOUT `)\n\n  process.exit(-1)\n}\nconst tag = process.env.BOILER_TAG\nconst dbname = process.env.BOILER_TAG\nconst host = process.env.BOILER_HOST\nconst bases = process.env.BOILER_BASES.split(',')\nconst mongoUri = `${process.env.BOILER_MONGO_URI}/${dbname}`\nconst timeout = process.env.BOILER_TIMEOUT || 20000\nconst silent = process.env.NODE_ENV === 'production'\n\nconst pin = `role:${tag}`\n\nconst opts = {\n  seneca: {\n    tag: tag,\n    internal: {logger: logger},\n    debug: {short_logs: true},\n    transport: {\n      web: {\n        timeout\n      }\n    }\n  },\n  mesh: {\n    pin,\n    bases,\n    host,\n    sneeze: {\n      silent\n    }\n  },\n  mongo: {\n    uri: mongoUri\n  }\n}\n\nSeneca(opts.seneca)\n  .use('entity')\n  .use('basic')\n  .use('mongo-store', opts.mongo)\n  .use(logic)\n  .use('mesh', opts.mesh)\n  .ready(function () {\n    console.log(this.id)\n  }\n  )\n"]}